{% extends "base.html" %}

{% block title %}Admin Dashboard - TezzaWorks{% endblock %}

{% block nav_links %}
<div class="flex items-center space-x-4">
    <span class="text-sm"><i class="fas fa-user mr-2"></i>{{ session.admin_username }}</span>
    <a href="{{ url_for('admin.logout') }}" class="text-sm hover:text-gray-200">
        <i class="fas fa-sign-out-alt mr-1"></i>Logout
    </a>
</div>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Dashboard Header -->
    <div class="mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">
            <i class="fas fa-tachometer-alt mr-3 text-purple-600"></i>
            Admin Dashboard
        </h1>
        <p class="text-gray-600">Manage design requests and client galleries</p>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white rounded-lg card-shadow p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-600 text-sm font-semibold mb-1">Pending Requests</p>
                    <p class="text-3xl font-bold text-yellow-600">{{ pending_requests|length }}</p>
                </div>
                <div class="bg-yellow-100 p-4 rounded-full">
                    <i class="fas fa-clock text-2xl text-yellow-600"></i>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg card-shadow p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-600 text-sm font-semibold mb-1">In Progress</p>
                    <p class="text-3xl font-bold text-blue-600">{{ in_progress_requests|length }}</p>
                </div>
                <div class="bg-blue-100 p-4 rounded-full">
                    <i class="fas fa-paint-brush text-2xl text-blue-600"></i>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-lg card-shadow p-6">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-gray-600 text-sm font-semibold mb-1">Completed</p>
                    <p class="text-3xl font-bold text-green-600">{{ completed_requests|length }}</p>
                </div>
                <div class="bg-green-100 p-4 rounded-full">
                    <i class="fas fa-check-circle text-2xl text-green-600"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Pending Requests Section -->
    {% if pending_requests %}
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
            <i class="fas fa-hourglass-half mr-3 text-yellow-600"></i>
            Pending Requests
        </h2>
        <div class="grid grid-cols-1 gap-6">
            {% for request in pending_requests %}
            <div class="bg-white rounded-lg card-shadow p-6 hover:shadow-xl transition duration-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-1">{{ request.company_name }}</h3>
                        <p class="text-gray-600 text-sm">
                            <i class="fas fa-user mr-2"></i>{{ request.contact_name }}
                            <span class="mx-2">|</span>
                            <i class="fas fa-envelope mr-2"></i>{{ request.contact_email }}
                        </p>
                    </div>
                    <span class="px-4 py-2 bg-yellow-100 text-yellow-700 rounded-full text-sm font-semibold">
                        Pending
                    </span>
                </div>

                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-700 mb-2">Brand Keywords:</p>
                    <p class="text-gray-600">{{ request.brand_keywords }}</p>
                </div>

                <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                    <span><i class="fas fa-calendar mr-2"></i>Submitted: {{ request.created_at.strftime('%b %d, %Y at %I:%M %p') }}</span>
                    <span><i class="fas fa-images mr-2"></i>0 designs uploaded</span>
                </div>

                <div class="flex space-x-3">
                    <a href="{{ url_for('admin.view_request', request_id=request.id) }}"
                       class="flex-1 bg-purple-600 text-white text-center py-2 px-4 rounded-lg hover:bg-purple-700 transition">
                        <i class="fas fa-eye mr-2"></i>View Details
                    </a>
                    <a href="{{ url_for('client.gallery', token=request.gallery_token) }}"
                       target="_blank"
                       class="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition">
                        <i class="fas fa-external-link-alt"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- In Progress Requests Section -->
    {% if in_progress_requests %}
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
            <i class="fas fa-paint-brush mr-3 text-blue-600"></i>
            In Progress
        </h2>
        <div class="grid grid-cols-1 gap-6">
            {% for request in in_progress_requests %}
            <div class="bg-white rounded-lg card-shadow p-6 hover:shadow-xl transition duration-200">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-1">{{ request.company_name }}</h3>
                        <p class="text-gray-600 text-sm">
                            <i class="fas fa-user mr-2"></i>{{ request.contact_name }}
                            <span class="mx-2">|</span>
                            <i class="fas fa-envelope mr-2"></i>{{ request.contact_email }}
                        </p>
                    </div>
                    <span class="px-4 py-2 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold">
                        In Progress
                    </span>
                </div>

                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-700 mb-2">Brand Keywords:</p>
                    <p class="text-gray-600">{{ request.brand_keywords }}</p>
                </div>

                <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                    <span><i class="fas fa-calendar mr-2"></i>Submitted: {{ request.created_at.strftime('%b %d, %Y') }}</span>
                    <span><i class="fas fa-images mr-2"></i>{{ request.designs|length }} designs uploaded</span>
                </div>

                <div class="flex space-x-3">
                    <a href="{{ url_for('admin.view_request', request_id=request.id) }}"
                       class="flex-1 bg-purple-600 text-white text-center py-2 px-4 rounded-lg hover:bg-purple-700 transition">
                        <i class="fas fa-eye mr-2"></i>View Details
                    </a>
                    <a href="{{ url_for('client.gallery', token=request.gallery_token) }}"
                       target="_blank"
                       class="bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition">
                        <i class="fas fa-external-link-alt"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Completed Requests Section -->
    {% if completed_requests %}
    <div class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
            <i class="fas fa-check-circle mr-3 text-green-600"></i>
            Completed
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            {% for request in completed_requests %}
            <div class="bg-white rounded-lg card-shadow p-6 hover:shadow-xl transition duration-200">
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800 mb-1">{{ request.company_name }}</h3>
                        <p class="text-gray-600 text-sm">{{ request.contact_name }}</p>
                    </div>
                    <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">
                        Completed
                    </span>
                </div>

                <div class="flex items-center justify-between text-xs text-gray-500 mb-3">
                    <span><i class="fas fa-calendar mr-1"></i>{{ request.created_at.strftime('%b %d, %Y') }}</span>
                    <span><i class="fas fa-images mr-1"></i>{{ request.designs|length }} designs</span>
                </div>

                <div class="flex space-x-2">
                    <a href="{{ url_for('admin.view_request', request_id=request.id) }}"
                       class="flex-1 bg-purple-600 text-white text-center py-2 px-3 rounded text-sm hover:bg-purple-700 transition">
                        <i class="fas fa-eye mr-1"></i>View
                    </a>
                    <a href="{{ url_for('client.gallery', token=request.gallery_token) }}"
                       target="_blank"
                       class="bg-gray-200 text-gray-700 py-2 px-3 rounded hover:bg-gray-300 transition">
                        <i class="fas fa-external-link-alt"></i>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- No Requests Message -->
    {% if not pending_requests and not in_progress_requests and not completed_requests %}
    <div class="text-center py-16">
        <i class="fas fa-inbox text-6xl text-gray-300 mb-6"></i>
        <h3 class="text-2xl font-bold text-gray-800 mb-2">No Design Requests Yet</h3>
        <p class="text-gray-600 mb-6">When clients submit design requests, they will appear here.</p>
        <a href="/" class="inline-block bg-purple-600 text-white py-3 px-6 rounded-lg hover:bg-purple-700 transition">
            <i class="fas fa-plus mr-2"></i>View Client Form
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
